SMI_LEDS_DIR = ~/src/smi_leds
SMI_LEDS_INCLUDE = -I $(SMI_LEDS_DIR)/include
SMI_LEDS_LIB = -L $(SMI_LEDS_DIR)/build -lsmi_leds

HWEEN_OBJS = hween.o perlin.o cmap.o tree.o worker.o http.o
PCXMAS_OBJS = hween-pcxmas.o perlin-pcxmas.o cmap-pcxmas.o tree-pcxmas.o worker-pcxmas.o http-pcxmas.o
STUB_OBJS = hween-stub.o perlin-stub.o cmap-stub.o tree-stub.o worker-stub.o http-stub.o
NOISE_IMAGE_OBJS = noise_image.o perlin.o

all: hween pcxmas stub noise_image

# Dependencies generated by copilot
hween.o: hween.cpp tree.h color.h hsv.h hween.h
perlin.o: perlin.cpp perlin.h
cmap.o: cmap.cpp cmap.h color.h
tree.o: tree.cpp tree.h color.h
worker.o: worker.cpp tree.h color.h
http.o: http.cpp http.h

hween: $(HWEEN_OBJS) tree.h color.h Makefile
	g++ -std=c++20 $(HWEEN_OBJS) $(SMI_LEDS_LIB) -pthread -o hween -g

pcxmas: $(PCXMAS_OBJS) tree.h color.h Makefile
	g++ -std=c++20 $(PCXMAS_OBJS) $(SMI_LEDS_LIB) -pthread -o pcxmas -g

stub: $(STUB_OBJS) tree.h color.h Makefile
	g++ -std=c++20 $(STUB_OBJS) -pthread -o stub -g

noise_image: $(NOISE_IMAGE_OBJS) Makefile
	g++ -std=c++20 $(NOISE_IMAGE_OBJS) -o noise_image -g

%.o: %.cpp Makefile
	g++ -std=c++20 $(SMI_LEDS_INCLUDE) -c $< -o $@

%-pcxmas.o: %.cpp Makefile
	g++ -std=c++20 -DTREE_V3 $(SMI_LEDS_INCLUDE) -c $< -o $@

%-stub.o: %.cpp Makefile
	g++ -std=c++20 -DTREE_V3 -DSTUB_LEDS $(SMI_LEDS_INCLUDE) -c $< -o $@

format:
	clang-format -i hween.cpp
	clang-format -i cmap.h
	clang-format -i color.h
	clang-format -i tree.h
	clang-format -i perlin.cpp
	clang-format -i perlin.h


clean:
	rm -f hween pcxmas stub noise_image
	rm -f example
	rm -f $(HWEEN_OBJS) $(PCXMAS_OBJS) $(STUB_OBJS) $(NOISE_IMAGE_OBJS)


SMI_LEDS_DIR = ~/src/smi_leds
SMI_LEDS_INCLUDE = -I $(SMI_LEDS_DIR)/include
SMI_LEDS_LIB = -L $(SMI_LEDS_DIR)/build -lsmi_leds

HWEEN_OBJS = hween.o perlin.o cmap.o tree.o worker.o
PCXMAS_OBJS = hween-pcxmas.o perlin-pcxmas.o cmap-pcxmas.o tree-pcxmas.o worker-pcxmas.o
NOISE_IMAGE_OBJS = noise_image.o perlin.o

all: hween pcxmas noise_image

# Dependencies generated by copilot
hween.o: hween.cpp tree.h color.h hsv.h
perlin.o: perlin.cpp perlin.h
cmap.o: cmap.cpp cmap.h color.h
tree.o: tree.cpp tree.h color.h
worker.o: worker.cpp tree.h color.h

hween: $(HWEEN_OBJS) tree.h color.h Makefile
	g++ -std=c++20 $(HWEEN_OBJS) $(SMI_LEDS_LIB) -o hween -g

pcxmas: $(PCXMAS_OBJS) tree.h color.h Makefile
	g++ -std=c++20 $(PCXMAS_OBJS) $(SMI_LEDS_LIB) -o pcxmas -g

noise_image: $(NOISE_IMAGE_OBJS) Makefile
	g++ -std=c++20 $(NOISE_IMAGE_OBJS) -o noise_image -g

%.o: %.cpp Makefile
	g++ -std=c++20 $(SMI_LEDS_INCLUDE) -c $< -o $@

%-pcxmas.o: %.cpp Makefile
	g++ -std=c++20 -DTREE_V3 $(SMI_LEDS_INCLUDE) -c $< -o $@

format:
	clang-format -i hween.cpp
	clang-format -i cmap.h
	clang-format -i color.h
	clang-format -i tree.h
	clang-format -i perlin.cpp
	clang-format -i perlin.h


clean:
	rm -f hween pcxmas noise_image
	rm -f example
	rm -f $(HWEEN_OBJS) $(PCXMAS_OBJS) $(NOISE_IMAGE_OBJS)

